---
source: /Users/hinrayleung/Downloads/期中.pdf
type: pdf
model: mistral-ocr-latest
processed: 2026-01-03T12:44:24.884451
---

# Document: 期中.pdf

## Table of Contents

- [Page 1](#page-1)
- [Page 2](#page-2)
- [Page 3](#page-3)
- [Page 4](#page-4)

## Page 1

*Metadata:*
- Width: 2339
- Height: 1653
- DPI: 200

北京师范大学 2024～2025 学年第二学期期中考试试卷

课程名称： 大数据处理 任课教师姓名： 陈红顺

卷图总分：100分 考试时长：100分钟 考试类别：闭卷 开卷 ☐ 其他 ☐

院（系）： 立理学院 专业： 人工智能 年级： 202

姓名： 陈红顺 学号： 2024029360

|  题号 | 第一题 | 第二题 | 第三题 | 第四题 |  | 总分  |
| --- | --- | --- | --- | --- | --- | --- |
|  得分 | 24 | 15 | 15 | 11 |  | 65  |

阅卷教师（签字）：

一、选择题（每空2分，共30分）

1. 下列对大数据的处理模式的描述中，不正确的是（☑）

A. 根据数据源及分析目标不同，数据处理通常可分为离线/批量和在线/实时两种模式
B. 批处理是指数据积累到一定程度再进行处理，多用于事后分析，如分析用户的消费模式
C. 在线/实时处理是指数据产生后需立即进行分析，如及时反馈用户在网络中发布的消息等
D. 典型的离线/批量处理平台是Storm，典型的在线/实时处理平台是Hadoop

2. HDFS是基于流数据模式访问和处理超大文件的需求而开发的，具有高容错、高可靠性、高可扩展性、高吞吐率等特点，适合的读写任务是（☑）

A. 一次写入，少次读
B. 多次写入，少次读
C. 多次写入，多次读
D. 一次写入，多次读

3. 下列关于HDFS的描述，不正确的是（☑）

A. HDFS采用了相应的数据存放、读取和复制策略，来提升系统整体读写响应性能
B. HDFS采用了主从（Master/Slave）结构模型
C. HDFS采用了冗余数据存储，增强了数据可靠性
D. HDFS采用块的概念，使得系统的设计变得更加复杂

4. 以下关于DataNode的主驱功能的描述，错误的是（☑）

A. 负责数据的存储和读取
B. 根据客户端或者是名称节点的调度来进行数据的存储和检索？
C. 向名称节点定期发送自己所存储的块的列表？

D. 用来保存名称节点中对HDFS元数据信息的备份，并减少名称节点里启的时间

若从Topic的分区数为3，消费者组内有4个消费者实例，会发生什么？（DA）

A. 3个消费者各自分配1个分区，1个消费者空间

B. 触发消费者组Rebalance失败

C. 所有消费者轮询消费所有分区

D. 消费者组抛出InvalidGroupSizeException

3. 图

A. 为数据的存储和读取

B. 根据客户端或者是名称节点的调度来进行数据的存储和检索？

6. 下面对Fslmage的描述，不正确的是（☑）

A. Fslmage文件没有记录每个块存储在哪个数据节点
B. Fslmage文件包含文件系统中所有目录和文件inode的序列化形式
C. Fslmage 用于维护文件系统树以及文件树中所有的文件和文件夹的元数据
D. Fslmage文件记录了每个块具体被存储在哪个数据节点

7. 关于HDFS数据块多副本存储的优点，不正确的（☑）

A. 加快数据传输速度
B. 容易检查数据错误
C. 保证数据可靠性
D. 适合多平台上运行

8. Kafka Producer的acks=all配置，如何保证数据可靠性？（☑）

A. 仅Leader写入成功即返回确认
B. Leader和至少一个Follower写入成功
C. Leader和所有Follower写入成功
D. Leader和所有ISR中的副本写入成功

9. 在HBase中，关于数据操作的描述，下列哪一项是错误的？（☑）

A. HBase采用了更加简单的数据模型，它的数据存储为未经解释的字符串
B. HBase将表分组成“列簇”的集合，列簇手机基本的访问控制单元
C. HBase不支持修改操作？
D. HBase在设计上就避免了复杂的表和表之间的关系

10. 如果需要再Storm Bolt中统计商品的实时点击量，应优先选择哪种流分组策略？（☑）

A. Shuffle Grouping
B. Fields Grouping（按商品ID分组）
C. All Grouping
D. Global Grouping

11. 下列关于MapReduce的说法，不正确的是（☑）

A. MapReduce具有广泛的应用，比如关系代数运算、分组与聚合运算等
B. MapReduce将复杂的、运行于大规模集群上的并行计算过程高度地抽象成两个函数

2页共7页

扫描全能王创建

## Page 2

*Metadata:*
- Width: 2339
- Height: 1653
- DPI: 200

C. 编程人员在不会分布式并行编程的情况下，也可以很容易将自己的程序运行在分布式系统上，完成海量数据集的计算

D. 不同的 Map 任务之间可以进行通信

12. 在 YARN 体系结构中，ApplicationMaster 主要功能不包括（ ☐ D ☑ ）

A. 当用户作业提交时，ApplicationMaster 与 ResourceManager 协商获取资源，ResourceManager 会以容器的形式为 ApplicationMaster 分配资源

B. 把获得的资源进一步分配给内部的各个任务（Map 任务或 Reduce 任务），实现资源的“二次分配”

C. 定时向 ResourceManager 发送“心跳”消息，报告资源的使用情况和应用的进度信息

D. 向 ResourceManager 正报作业的资源使用情况和每个容器的运行状态

容器运行状态由NodeManager监控

13. 下列关于 Map 和 Reduce 函数的描述，不正确的是（ ☐ C ☑ ）

A. Map 将小数据集进一步解析成一批<key,value>对，输入 Map 函数中进行处理

B. Map 每一个输入的<k 1="" ,v="">&gt;会输出一批<k 2="" ,v="">&gt;，<k 2="" ,v="">&gt;是计算的中间结果

C. Reduce 输入的中间结果<k 2="" ,list(v="2)&gt;中的 List(v 2)表示是一组属于不同 k 2 的 value

D. Reduce 最终输出也是<k ,v="">类型

14. 下面关于 NoSQL 和关系数据库的简单比较，不正确的是（ ☑ B ☑ ）

A. RDBMS 有关系代数理论作为基础，NoSQL 没有统一的理论基础

B. NoSQL 很难实现输出代码，RDBMS 可以很容易通过添加更多设备来支持更大规模的数据

C. RDBMS 浴室定义数据库模式，严格遵守数据定义，NoSQL 一般不存在数据库模式，可以自由灵活定义并存储各种不同类型的数据

D. RDBMS 借助于索引机制可以实现快速查询，很多 NoSQL 数据库没有面向复杂查询的索引

15. 下面关于 Hbase 中 Master 工作的描述，不正确的是（ ☑ D ☑ ）

A. 在 Region 分裂或合并后，负责重新调整 Region 的分布

B. 对发生故障失败的 Region 服务器上的 Region 进行迁移

C. 管理用户对表的增加、删除、修改、查询等操作

D. 不支持不同 Region 服务器之间的负载功能

二、简答题（每小题 5 分，共 25 分）

1. 请简述 HDFS 与文件的流程。

① 先向NameNode请求写文件

② 采用还未设置到的方式写入到一个副本中

2. 请简述 Hadoop YARN 的体系结构。

Hadoop YARN 由 ResourceManager、NodeManager、ApplicationMaster、和 Container 组成。

3. 简述在 HBase 的三层结构下，客户端是如何访问到数据的？

① 客户端 请求 ZooKeeper，访问到 -ROOT - 表中址。

② 通过访问 -ROOT 表得到 -META - 表中址。

③ 通过访问 -META - 表，得到 数据所在 Region 中址。

④ 在 Region 中找到数据。

4. 请简述 Kafka 的 ISR 机制。

① Moot 值导航和维护一个 ISR 列表，保持原版者副本同荣

② 如果原版者副本 - 段时间未请求值导航，则把类从 ISR 中删除

③ 当原版者重新加入到与值导航保持同步时，重新加入到 ISR。

④ 当值导航失败时，ZoKeeper 在没有 ISR 中重新选取值导航，并同步的原版者不会初选取

第 3 页 共 7 页

扫描全能王 创建</k></k></k></k></k></k></k></k>

## Page 3

*Metadata:*
- Width: 2339
- Height: 1653
- DPI: 200

行政务 2021.07.26

5. 请简述 Storm 如何通过 Acker 机制 实现 “At Least Once”语义。

Acker 机制 可以保证满意少数 Leader 语义信道
最强处理。

三、综合题（共 2 小题，共 30 分）

1. 现需要基于 Storm 开发一套实时大数据系统，要求从 Kafka(Topic user_actions)实时读取用户行为数据（字段：user_id, action_type, product_id, timestamp, 其中 action_type 包括：click（点击）、purchase（购买）、search（搜索）），根据用户行为类型动态实现如下功能：
（1）统计被所有用户高额点击的前 10 种商品，按照总点击量从高到低排序；（2）判出最近 10 种被购买的商品及购买用户。

请设计一个 Topology，并详细说明各组件的主要功能及采用的流分组策略。（15 分）

设计①：Field Group，根据 product-id, action-type == click 对商品进行
设计②：Field Group，根据 product-id 对商品和设备进行
设计③：排序，转入前 10 商品

设计①：Field Group，排序，按时调整 timestamp 从大到小排序
设计②：Field Group，排到 action-type ==
设计③：Field Group，根据 action-type == purchase 对行为筛选。
设计④：排序，转入前 10 商品及用户

2. 现有一网站记录了每一个广告被点击情况，记录的数据格式包括时间戳、用户、广告三个字段（字段之间使用空格分割）。

数据样本如下：
1516609143867 64 16
1516609143869 75 18
1516609143869 87 12

现因业务应用需要，需要统计出总点击量在 1000 次以上的广告及点击量。请结合 MapReduce 编程模型给出设计思路和核心代码（给出 map 函数和 reduce 函数的核心代码即可）（15 分）。

Map 降段：以下当为副题：第 1 页值增点击量当为副题时，

Sup 降段：将产生点击量转入为 &lt;产生，不计1&gt;

Reduce 降段：对每个产生点击副题进行实加，加入于等于 1000 种类记录并转入。

10

扫描全能王 创建

## Page 4

*Metadata:*
- Width: 1653
- Height: 2339
- DPI: 200

四、论述题（共15分）

1. 请结合大数据处理场景，论述批处理（Batch Processing）与流处理（Stream Processing）的核心差异、技术挑战及适用场景。

批处理适用于有界数据,批量淡入,集中处理,逐次高卷吐;

流处理适用于无界数据,实时处理,逐次快送达.

大数据处理场景下的批线主要有:

批处理的批线有: ①高送达. ②性能粗细.

流处理的批线有 ① 数据流到达时间的时间不平衡性导航, ② 向集群体惯性问题, ③ 时更高实时性的需求。

批处理适用于如图 ① 处理, 数据连链等场景.

流处理适用于如 电商订单交易 等高实时场景.

扫描全能王 创建

---

*Generated by Mistral OCR MCP Server*
